Traceback (most recent call last):
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/usr/lib64/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/jnapolitano/venvs/sphinx-build/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
def marketing_query():

    query_string = """
        SELECT fullVisitorId
        ,COUNT(DISTINCT visitId) AS num_sessions
        ,SUM(totals.pageviews) AS num_pageviews
        ,SUM(totals.hits) AS num_hits
        ,SUM(totals.timeOnSite) AS total_timeonsite
        ,MAX(CASE WHEN trafficSource.medium = '(none)' THEN 1 ELSE 0 END) AS medium_direct
        ,MAX(CASE WHEN trafficSource.medium = 'organic' THEN 1 ELSE 0 END) AS medium_organic
        ,MAX(CASE WHEN trafficSource.medium = 'referral' THEN 1 ELSE 0 END) AS medium_referral
        ,MAX(CASE WHEN trafficSource.medium NOT IN ('(none)', 'organic', 'referral') THEN 1 ELSE 0 END) AS medium_other
        ,MAX(CASE WHEN device.deviceCategory = 'mobile' THEN 1 ELSE 0 END) AS device_mobile
        ,MAX(CASE WHEN device.deviceCategory = 'desktop' THEN 1 ELSE 0 END) AS device_desktop
        ,MAX(CASE WHEN device.deviceCategory = 'tablet' THEN 1 ELSE 0 END) AS device_tablet
        ,SUM(totals.transactions) AS transactions
        FROM `bigquery-public-data.google_analytics_sample.ga_sessions_2017*`
        GROUP BY fullVisitorId
         """
    result = query_big_query(query_string)
    return result.to_dataframe()

df_first_try = marketing_query()
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mDefaultCredentialsError[0m                   Traceback (most recent call last)
Input [0;32mIn [4][0m, in [0;36m<cell line: 23>[0;34m()[0m
[1;32m     20[0m     result [38;5;241m=[39m query_big_query(query_string)
[1;32m     21[0m     [38;5;28;01mreturn[39;00m result[38;5;241m.[39mto_dataframe()
[0;32m---> 23[0m df_first_try [38;5;241m=[39m marketing_query()

Input [0;32mIn [4][0m, in [0;36mmarketing_query[0;34m()[0m
[1;32m      1[0m [38;5;28;01mdef[39;00m [38;5;21mmarketing_query[39m():
[1;32m      3[0m     query_string [38;5;241m=[39m [38;5;124m"""[39m
[1;32m      4[0m [38;5;124m        SELECT fullVisitorId[39m
[1;32m      5[0m [38;5;124m        ,COUNT(DISTINCT visitId) AS num_sessions[39m
[0;32m   (...)[0m
[1;32m     18[0m [38;5;124m        GROUP BY fullVisitorId[39m
[1;32m     19[0m [38;5;124m         [39m[38;5;124m"""[39m
[0;32m---> 20[0m     result [38;5;241m=[39m [43mquery_big_query[49m[43m([49m[43mquery_string[49m[43m)[49m
[1;32m     21[0m     [38;5;28;01mreturn[39;00m result[38;5;241m.[39mto_dataframe()

Input [0;32mIn [2][0m, in [0;36mquery_big_query[0;34m(query_string)[0m
[1;32m      1[0m [38;5;28;01mdef[39;00m [38;5;21mquery_big_query[39m(query_string):
[0;32m----> 2[0m     client [38;5;241m=[39m [43mbigquery[49m[38;5;241;43m.[39;49m[43mClient[49m[43m([49m[43m)[49m
[1;32m      3[0m     query_job [38;5;241m=[39m client[38;5;241m.[39mquery(query_string)
[1;32m      5[0m     results [38;5;241m=[39m query_job[38;5;241m.[39mresult()  [38;5;66;03m# Waits for job to complete.[39;00m

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/cloud/bigquery/client.py:226[0m, in [0;36mClient.__init__[0;34m(self, project, credentials, _http, location, default_query_job_config, client_info, client_options)[0m
[1;32m    216[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m(
[1;32m    217[0m     [38;5;28mself[39m,
[1;32m    218[0m     project[38;5;241m=[39m[38;5;28;01mNone[39;00m,
[0;32m   (...)[0m
[1;32m    224[0m     client_options[38;5;241m=[39m[38;5;28;01mNone[39;00m,
[1;32m    225[0m ) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[0;32m--> 226[0m     [38;5;28;43msuper[39;49m[43m([49m[43mClient[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m
[1;32m    227[0m [43m        [49m[43mproject[49m[38;5;241;43m=[39;49m[43mproject[49m[43m,[49m
[1;32m    228[0m [43m        [49m[43mcredentials[49m[38;5;241;43m=[39;49m[43mcredentials[49m[43m,[49m
[1;32m    229[0m [43m        [49m[43mclient_options[49m[38;5;241;43m=[39;49m[43mclient_options[49m[43m,[49m
[1;32m    230[0m [43m        [49m[43m_http[49m[38;5;241;43m=[39;49m[43m_http[49m[43m,[49m
[1;32m    231[0m [43m    [49m[43m)[49m
[1;32m    233[0m     kw_args [38;5;241m=[39m {[38;5;124m"[39m[38;5;124mclient_info[39m[38;5;124m"[39m: client_info}
[1;32m    234[0m     bq_host [38;5;241m=[39m _get_bigquery_host()

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/cloud/client/__init__.py:320[0m, in [0;36mClientWithProject.__init__[0;34m(self, project, credentials, client_options, _http)[0m
[1;32m    319[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, project[38;5;241m=[39m[38;5;28;01mNone[39;00m, credentials[38;5;241m=[39m[38;5;28;01mNone[39;00m, client_options[38;5;241m=[39m[38;5;28;01mNone[39;00m, _http[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[0;32m--> 320[0m     [43m_ClientProjectMixin[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mproject[49m[38;5;241;43m=[39;49m[43mproject[49m[43m,[49m[43m [49m[43mcredentials[49m[38;5;241;43m=[39;49m[43mcredentials[49m[43m)[49m
[1;32m    321[0m     Client[38;5;241m.[39m[38;5;21m__init__[39m(
[1;32m    322[0m         [38;5;28mself[39m, credentials[38;5;241m=[39mcredentials, client_options[38;5;241m=[39mclient_options, _http[38;5;241m=[39m_http
[1;32m    323[0m     )

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/cloud/client/__init__.py:268[0m, in [0;36m_ClientProjectMixin.__init__[0;34m(self, project, credentials)[0m
[1;32m    265[0m     project [38;5;241m=[39m [38;5;28mgetattr[39m(credentials, [38;5;124m"[39m[38;5;124mproject_id[39m[38;5;124m"[39m, [38;5;28;01mNone[39;00m)
[1;32m    267[0m [38;5;28;01mif[39;00m project [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 268[0m     project [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_determine_default[49m[43m([49m[43mproject[49m[43m)[49m
[1;32m    270[0m [38;5;28;01mif[39;00m project [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    271[0m     [38;5;28;01mraise[39;00m [38;5;167;01mEnvironmentError[39;00m(
[1;32m    272[0m         [38;5;124m"[39m[38;5;124mProject was not passed and could not be [39m[38;5;124m"[39m
[1;32m    273[0m         [38;5;124m"[39m[38;5;124mdetermined from the environment.[39m[38;5;124m"[39m
[1;32m    274[0m     )

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/cloud/client/__init__.py:287[0m, in [0;36m_ClientProjectMixin._determine_default[0;34m(project)[0m
[1;32m    284[0m [38;5;129m@staticmethod[39m
[1;32m    285[0m [38;5;28;01mdef[39;00m [38;5;21m_determine_default[39m(project):
[1;32m    286[0m     [38;5;124;03m"""Helper:  use default project detection."""[39;00m
[0;32m--> 287[0m     [38;5;28;01mreturn[39;00m [43m_determine_default_project[49m[43m([49m[43mproject[49m[43m)[49m

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/cloud/_helpers/__init__.py:152[0m, in [0;36m_determine_default_project[0;34m(project)[0m
[1;32m    140[0m [38;5;124;03m"""Determine default project ID explicitly or implicitly as fall-back.[39;00m
[1;32m    141[0m 
[1;32m    142[0m [38;5;124;03mSee :func:`google.auth.default` for details on how the default project[39;00m
[0;32m   (...)[0m
[1;32m    149[0m [38;5;124;03m:returns: Default project if it can be determined.[39;00m
[1;32m    150[0m [38;5;124;03m"""[39;00m
[1;32m    151[0m [38;5;28;01mif[39;00m project [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 152[0m     _, project [38;5;241m=[39m [43mgoogle[49m[38;5;241;43m.[39;49m[43mauth[49m[38;5;241;43m.[39;49m[43mdefault[49m[43m([49m[43m)[49m
[1;32m    153[0m [38;5;28;01mreturn[39;00m project

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/auth/_default.py:546[0m, in [0;36mdefault[0;34m(scopes, request, quota_project_id, default_scopes)[0m
[1;32m    534[0m checkers [38;5;241m=[39m (
[1;32m    535[0m     [38;5;66;03m# Avoid passing scopes here to prevent passing scopes to user credentials.[39;00m
[1;32m    536[0m     [38;5;66;03m# with_scopes_if_required() below will ensure scopes/default scopes are[39;00m
[0;32m   (...)[0m
[1;32m    542[0m     [38;5;28;01mlambda[39;00m: _get_gce_credentials(request),
[1;32m    543[0m )
[1;32m    545[0m [38;5;28;01mfor[39;00m checker [38;5;129;01min[39;00m checkers:
[0;32m--> 546[0m     credentials, project_id [38;5;241m=[39m [43mchecker[49m[43m([49m[43m)[49m
[1;32m    547[0m     [38;5;28;01mif[39;00m credentials [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m    548[0m         credentials [38;5;241m=[39m with_scopes_if_required(
[1;32m    549[0m             credentials, scopes, default_scopes[38;5;241m=[39mdefault_scopes
[1;32m    550[0m         )

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/auth/_default.py:539[0m, in [0;36mdefault.<locals>.<lambda>[0;34m()[0m
[1;32m    528[0m [38;5;28;01mfrom[39;00m [38;5;21;01mgoogle[39;00m[38;5;21;01m.[39;00m[38;5;21;01mauth[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcredentials[39;00m [38;5;28;01mimport[39;00m CredentialsWithQuotaProject
[1;32m    530[0m explicit_project_id [38;5;241m=[39m os[38;5;241m.[39menviron[38;5;241m.[39mget(
[1;32m    531[0m     environment_vars[38;5;241m.[39mPROJECT, os[38;5;241m.[39menviron[38;5;241m.[39mget(environment_vars[38;5;241m.[39mLEGACY_PROJECT)
[1;32m    532[0m )
[1;32m    534[0m checkers [38;5;241m=[39m (
[1;32m    535[0m     [38;5;66;03m# Avoid passing scopes here to prevent passing scopes to user credentials.[39;00m
[1;32m    536[0m     [38;5;66;03m# with_scopes_if_required() below will ensure scopes/default scopes are[39;00m
[1;32m    537[0m     [38;5;66;03m# safely set on the returned credentials since requires_scopes will[39;00m
[1;32m    538[0m     [38;5;66;03m# guard against setting scopes on user credentials.[39;00m
[0;32m--> 539[0m     [38;5;28;01mlambda[39;00m: [43m_get_explicit_environ_credentials[49m[43m([49m[43mquota_project_id[49m[38;5;241;43m=[39;49m[43mquota_project_id[49m[43m)[49m,
[1;32m    540[0m     [38;5;28;01mlambda[39;00m: _get_gcloud_sdk_credentials(quota_project_id[38;5;241m=[39mquota_project_id),
[1;32m    541[0m     _get_gae_credentials,
[1;32m    542[0m     [38;5;28;01mlambda[39;00m: _get_gce_credentials(request),
[1;32m    543[0m )
[1;32m    545[0m [38;5;28;01mfor[39;00m checker [38;5;129;01min[39;00m checkers:
[1;32m    546[0m     credentials, project_id [38;5;241m=[39m checker()

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/auth/_default.py:218[0m, in [0;36m_get_explicit_environ_credentials[0;34m(quota_project_id)[0m
[1;32m    215[0m     [38;5;28;01mreturn[39;00m _get_gcloud_sdk_credentials(quota_project_id[38;5;241m=[39mquota_project_id)
[1;32m    217[0m [38;5;28;01mif[39;00m explicit_file [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 218[0m     credentials, project_id [38;5;241m=[39m [43mload_credentials_from_file[49m[43m([49m
[1;32m    219[0m [43m        [49m[43mos[49m[38;5;241;43m.[39;49m[43menviron[49m[43m[[49m[43menvironment_vars[49m[38;5;241;43m.[39;49m[43mCREDENTIALS[49m[43m][49m[43m,[49m[43m [49m[43mquota_project_id[49m[38;5;241;43m=[39;49m[43mquota_project_id[49m
[1;32m    220[0m [43m    [49m[43m)[49m
[1;32m    222[0m     [38;5;28;01mreturn[39;00m credentials, project_id
[1;32m    224[0m [38;5;28;01melse[39;00m:

File [0;32m~/venvs/sphinx-build/lib/python3.9/site-packages/google/auth/_default.py:117[0m, in [0;36mload_credentials_from_file[0;34m(filename, scopes, default_scopes, quota_project_id, request)[0m
[1;32m     85[0m [38;5;124;03m"""Loads Google credentials from a file.[39;00m
[1;32m     86[0m 
[1;32m     87[0m [38;5;124;03mThe credentials file must be a service account key, stored authorized[39;00m
[0;32m   (...)[0m
[1;32m    114[0m [38;5;124;03m        wrong format or is missing.[39;00m
[1;32m    115[0m [38;5;124;03m"""[39;00m
[1;32m    116[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m os[38;5;241m.[39mpath[38;5;241m.[39mexists(filename):
[0;32m--> 117[0m     [38;5;28;01mraise[39;00m exceptions[38;5;241m.[39mDefaultCredentialsError(
[1;32m    118[0m         [38;5;124m"[39m[38;5;124mFile [39m[38;5;132;01m{}[39;00m[38;5;124m was not found.[39m[38;5;124m"[39m[38;5;241m.[39mformat(filename)
[1;32m    119[0m     )
[1;32m    121[0m [38;5;28;01mwith[39;00m io[38;5;241m.[39mopen(filename, [38;5;124m"[39m[38;5;124mr[39m[38;5;124m"[39m) [38;5;28;01mas[39;00m file_obj:
[1;32m    122[0m     [38;5;28;01mtry[39;00m:

[0;31mDefaultCredentialsError[0m: File /Users/jnapolitano/Projects/pmc-submission/creds.json was not found.
DefaultCredentialsError: File /Users/jnapolitano/Projects/pmc-submission/creds.json was not found.

